<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brandweer Herentals â€” Portal</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#c71f1f">

  <!-- Styling: brandweer rood / zwart / wit -->
  <style>
    :root{
      --red:#c71f1f;
      --dark:#111;
      --light:#fff;
      --muted:#f6f6f6;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{margin:0; padding:0; height:100%;}
    body{
      background: linear-gradient(180deg, #fff 0%, #f8f8f8 100%);
      display:flex;
      justify-content:center;
      padding:20px;
      -webkit-font-smoothing:antialiased;
    }

    .container{
      width:100%;
      max-width:780px;
      background:var(--light);
      border-radius:18px;
      border:4px solid var(--red);
      box-shadow:0 8px 30px rgba(0,0,0,0.08);
      overflow:hidden;
    }

    header{
      display:flex;
      align-items:center;
      gap:12px;
      padding:18px;
      background:linear-gradient(90deg, var(--red), #8f1515);
      color:var(--light);
    }
    header .logo{
      width:52px;
      height:52px;
      border-radius:10px;
      background:rgba(255,255,255,0.08);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:20px;
    }
    header h1{margin:0;font-size:18px;}
    header p{margin:0;font-size:12px;opacity:0.9;}

    .content{padding:18px;}
    .grid{display:grid; gap:12px; grid-template-columns:1fr;}
    @media(min-width:620px){.grid{grid-template-columns:1fr 1fr;}}

    .btn{
      display:flex;
      align-items:center;
      gap:14px;
      padding:16px;
      border-radius:12px;
      text-decoration:none;
      font-weight:700;
      font-size:16px;
      box-shadow:0 4px 8px rgba(0,0,0,0.04);
      transition:.06s;
      color:var(--dark);
      background:var(--muted);
    }
    .btn:active{transform:translateY(1px);}
    .btn .icon{
      width:52px;
      height:52px;
      min-width:52px;
      border-radius:10px;
      background:linear-gradient(180deg,#fff,#f0f0f0);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
      box-shadow:0 2px 6px rgba(0,0,0,0.06);
    }
    .btn small{display:block;font-size:12px;opacity:0.8;margin-top:4px;}
    .primary{
      background: linear-gradient(90deg,var(--red),#9c1616);
      color:var(--light);
    }
    .primary .icon{background: rgba(255,255,255,0.08); color:var(--light);}
    footer{
      padding:12px 18px;
      font-size:13px;
      color:#444;
      background:#fff;
      border-top:1px solid #eee;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    /* Install / update banners */
    #installBtn, #updateBanner{
      display:none;
      position:fixed;
      bottom:20px;
      left:50%;
      transform:translateX(-50%);
      background:#c71f1f;
      color:white;
      padding:12px 20px;
      border-radius:12px;
      font-weight:700;
      z-index:9999;
      box-shadow:0 2px 8px rgba(0,0,0,0.3);
      cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="container" role="application" aria-label="Fire Crew Herentals portal">
    <header>
      <div class="logo" aria-hidden="true">BWH</div>
      <div>
        <h1>Brandweer Herentals</h1>
        <p>Interne app</p>
      </div>
    </header>

    <main class="content">
      <div class="grid" id="buttonsGrid">
        <a href="#" id="btn-defect" class="btn primary"><div class="icon">ðŸ”§</div><div><div>Defectmelding</div><small>Meld snel defecten aan materiaal of voertuigen</small></div></a>
        <a href="#" id="btn-vehicle" class="btn"><div class="icon">ðŸš’</div><div><div>Voertuigreservatie</div><small>Reserveer een voertuig of controleer beschikbaarheid</small></div></a>
        <a href="#" id="btn-order" class="btn"><div class="icon">ðŸ“¦</div><div><div>Bestelling</div><small>Bestel materiaal of verbruiksgoederen</small></div></a>
        <a href="#" id="btn-verdi" class="btn"><div class="icon"><img src="icons/buttons/verdi.png" alt="" style="width:100%;height:100%;border-radius:10px;"></div><div><div>Verdi</div><small>Oproepen en status aanpassen</small></div></a>
        <a href="#" id="btn-abiweb" class="btn"><div class="icon"> <img src="icons/buttons/abiweb.png" alt="" style="width:100%;height:100%;border-radius:10px;"></div><div><div>Abiweb</div><small>Oefeningen en prestaties</small></div></a>
      </div>
    </main>

    <footer>
      <div class="small">Versie 1.0 â€”</div>
      <div class="small">Open in je telefoon: voeg toe aan beginscherm voor snelle toegang</div>
    </footer>
  </div>

  <!-- Banner voor nieuwe versie -->
  <div id="updateBanner">ðŸ”„ Nieuwe versie beschikbaar â€” tik om te verversen</div>

  <!-- Banner voor install -->
  <div id="installBtn">ðŸ“± App toevoegen aan startscherm</div>

  <script>
    // Links aanpassen
    const links = {
      defect: "https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUNTZUNVFFSUQwRldXTkpKREpGVlYyUzIwWC4u",
      vehicle: "https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUN0JBTzkySTI0STFZUlk4Q01GOVRTR1UzMy4u", 
      order: "https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUNFdJQlNJREREVTZFTkM2QUhJWlhaV1NWSS4u",
      verdi: "https://kempen.verdi.cloud/",
      abiweb: "https://identity.brandweerzonekempen.be/Identity/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%3Fclient_id%3Dabiweb.client.new"
    };

    document.getElementById("btn-defect").href = links.defect;
    document.getElementById("btn-vehicle").href = links.vehicle;
    document.getElementById("btn-order").href = links.order;
    document.getElementById("btn-verdi").href = links.verdi;
    document.getElementById("btn-abiweb").href = links.abiweb;

    // Add to Home Screen knop
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', e => {
      e.preventDefault();
      deferredPrompt = e;
      installBtn.style.display = 'block';
    });

    installBtn.addEventListener('click', async () => {
      if(deferredPrompt){
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        deferredPrompt = null;
      } else {
        alert('ðŸ“² Om de app te installeren: tik op de drie puntjes â‹® bovenaan in Chrome, en kies "App installeren" of "Toevoegen aan startscherm".');
      }
    });

    // Register service worker
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('sw.js').then(reg => {
        console.log('SW geregistreerd');

        navigator.serviceWorker.addEventListener('message', e => {
          if(e.data && e.data.type === 'NEW_VERSION_AVAILABLE'){
            const banner = document.getElementById('updateBanner');
            banner.style.display='block';
            banner.onclick = () => { banner.style.display='none'; window.location.reload(true); };
          }
        });
      });
    }
  </script>
</body>
</html>

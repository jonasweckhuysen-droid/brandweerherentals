<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Brandweer Herentals â€” Portal</title>

<link rel="manifest" href="/brandweerherentals/manifest.json">
<meta name="theme-color" content="#c71f1f">
<link rel="stylesheet" href="style.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
#nameOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.92);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10000;
  color:#fff;
}
.box{
  background:#111;
  padding:28px;
  border-radius:16px;
  max-width:360px;
  width:100%;
  text-align:center;
}
input,button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  margin-top:10px;
}
button{
  background:#c71f1f;
  color:#fff;
  font-weight:700;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 16px;
  background:#c71f1f;
  color:#fff;
}
.header-left img{ height:56px; }
.header-right div{ margin:2px 0; }
footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px 16px;
}
footer button{
  background:#333;
  padding:8px 14px;
  font-size:14px;
  color:#fff;
  border:none;
  border-radius:8px;
}
</style>
</head>

<body>

<!-- LOGIN OVERLAY -->
<div id="nameOverlay" style="display:none;">
  <div class="box">
    <h2>ðŸ‘¤ Identificatie</h2>
    <input id="nameInput" placeholder="Voornaam Achternaam">
    <button id="saveName">Verder</button>
    <small id="nameError" style="color:#ff6b6b;display:none;">
      Naam niet herkend
    </small>
  </div>
</div>

<div class="container" style="display:none;" id="appContent">

<header>
  <div class="header-left">
    <img src="logo.png" alt="Brandweer Herentals">
  </div>
  <div class="header-right">
    <div id="greeting"></div>
    <div id="datetime"></div>
  </div>
</header>

<main class="content">
  <div class="grid" id="buttonGrid"></div>
</main>

<footer>
  <div>Versie 1.2</div>
  <button onclick="logout()">Uitloggen</button>
</footer>

</div>

<script>
/**************** FIREBASE ****************/
firebase.initializeApp({
  databaseURL: "https://post-herentals-default-rtdb.europe-west1.firebasedatabase.app/"
});
const db = firebase.database();

/**************** LINKS ****************/
const links = {
  agenda:{title:"Agenda",icon:"ðŸ“…",desc:"Belangrijke data",url:"/brandweerherentals/agenda.html",roles:[]},
  verdi:{title:"Verdi",icon:"ðŸ“Ÿ",desc:"Oproepen",url:"https://kempen.verdi.cloud/",roles:[]},
  abiweb:{title:"Abiweb",icon:"ðŸ“š",desc:"Oefeningen",url:"https://abiweb.brandweerzonekempen.be/",roles:[]},
  defect:{title:"Defectmelding",icon:"ðŸ”§",desc:"Meld defecten",url:"/brandweerherentals/defectmelding.html",roles:[]},
  order:{title:"Bestelling",icon:"ðŸ“¦",desc:"Materiaal",url:"https://forms.cloud.microsoft/e/GjHr1Kym0w",roles:[]},
  vehicle:{title:"Voertuigreservatie",icon:"ðŸš’",desc:"Reservaties",url:"/brandweerherentals/voertuigen.html",roles:[]},
  permanentie:{title:"Permanentie",icon:"ðŸ•’",desc:"Permanentieplanning",url:"/brandweerherentals/permanentieopgave.html",roles:[]},
  admin:{title:"Admin",icon:"ðŸ› ï¸",desc:"Beheer",url:"/brandweerherentals/admin.html",roles:["admin"]}
};

/**************** HELPERS ****************/
function normalizeName(name){
  return name.trim().replace(/\s+/g," ").toLowerCase();
}

/**************** LOGIN ****************/
saveName.onclick = () => {
  const name = normalizeName(nameInput.value);

  db.ref("users/" + name).once("value", snap => {
    if (!snap.exists()) {
      nameError.style.display = "block";
      return;
    }

    localStorage.setItem("userName", name);
    location.reload();
  });
};

/**************** GRID ****************/
function renderGrid(){
  const userKey = localStorage.getItem("userName");

  db.ref("users/" + userKey).once("value", snap => {
    if (!snap.exists()) return;

    const data = snap.val();
    const roles = data.roles || [];

    greeting.innerText = `Welkom ${data.displayName}`;

    const grid = document.getElementById("buttonGrid");
    grid.innerHTML = "";

    Object.values(links)
      .sort((a,b)=>a.title.localeCompare(b.title,"nl"))
      .forEach(l=>{
        if(l.roles.length && !l.roles.some(r=>roles.includes(r))) return;

        const a=document.createElement("a");
        a.className="btn";
        a.href=l.url;
        a.innerHTML=`
          <div class="icon">${l.icon}</div>
          <div>
            <div>${l.title}</div>
            <small>${l.desc}</small>
          </div>
        `;
        grid.appendChild(a);
      });
  });
}

/**************** LOGOUT ****************/
function logout(){
  localStorage.removeItem("userName");
  location.reload();
}

/**************** DATETIME ****************/
setInterval(()=>{
  document.getElementById("datetime").innerText =
    new Date().toLocaleString("nl-BE");
},1000);

/**************** START ****************/
window.addEventListener("DOMContentLoaded",()=>{
  if(!localStorage.getItem("userName")){
    nameOverlay.style.display="flex";
    return;
  }
  appContent.style.display="block";
  renderGrid();
});
</script>
<script>
/************ EENMALIGE INIT PERSONEEL ************/
const personeel = {
  "Dirk Geens":["officier","bevelvoerder"],
  "Sus Meulemans":["officier"],
  "Gerry Verschueren":["officier"],
  "Danny Van den Bergh":["officier","bevelvoerder","duiker","admin"],
  "Bart Verbiest":["ambulancier"],
  "Johan Peeters":["ambulancier"],
  "Seffi Vleugels":["ambulancier"],
  "Dries Boven":["bevelvoerder","chauffeur","brandweer"],
  "Pedro Wallyn":["bevelvoerder","chauffeur","brandweer","duiker"],
  "Bart Leten":["chauffeur","brandweer"],
  "Steven Maes":["chauffeur","ambulancier","brandweer"],
  "Bart Cools":["chauffeur","brandweer"],
  "Joris Peeters":["brandweer"],
  "Bram Addiers":["brandweer"],
  "Robin Buyens":["chauffeur","brandweer","ambulancier"],
  "Maarten Geerinckx":["brandweer"],
  "Pieter Van Doninck":["brandweer"],
  "Bart Govaerts":["bevelvoerder","brandweer"],
  "Roel Dekort":["chauffeur","ambulancier","brandweer"],
  "Jonas Weckhuysen":["chauffeur","ambulancier","brandweer","duiker","admin"],
  "Luc Verwimp":["brandweer"],
  "Kris Van Looveren":["brandweer"],
  "Kurt Cools":["chauffeur","duiker","brandweer"],
  "Simon Baeyens":["ambulancier","brandweer"],
  "Mike Dillen":["brandweer"],
  "Lies Van Peer":["brandweer"],
  "Frank Verschueren":["bevelvoerder","chauffeur","brandweer"],
  "Rudi Van den Bergh":["ambulancier","brandweer"],
  "Patrick Van Hove":["ambulancier","brandweer","chauffeur","duiker","admin"],
  "Patrick Veris":["brandweer"],
  "Kris Hoeylaerts":["brandweer","chauffeur"],
  "NoÃ«l Van Roy":["brandweer","chauffeur"],
  "Ignas De Keyser":["brandweer"],
  "Joris Nyssen":["brandweer"],
  "Deuis Mulop":["brandweer"],
  "Evy FranÃ§ois":["brandweer"],
  "Jan Laeremans":["bevelvoerder","brandweer"],
  "Kristof Geens":["bevelvoerder","brandweer"],
  "Vincent Leemans":["chauffeur","ambulancier","brandweer"],
  "Sven Van Buren":["chauffeur","ambulancier","brandweer"],
  "Jef Leysen":["brandweer","duiker"],
  "Steven Vervloet":["chauffeur","brandweer"],
  "Liese Meyskens":["chauffeur","brandweer"],
  "Jens Van den Bruel":["brandweer"],
  "Dries Van der Linden":["brandweer"],
  "Thibo Van Doninck":["brandweer","ambulancier"],
  "Emiel Luyten":["bevelvoerder","brandweer"],
  "Jef Luyten":["bevelvoerder","ambulancier","brandweer"],
  "Rutger Moons":["bevelvoerder","chauffeur","brandweer"],
  "Philippe Hoeylaerts":["ambulancier","chauffeur","brandweer"],
  "Gianni Cornelis":["ambulancier","chauffeur","brandweer"],
  "Danny Van den Broeck":["chauffeur","brandweer"],
  "Bart Boons":["ambulancier","duiker","brandweer"],
  "Jochen Smolders":["brandweer"],
  "Vincent Fassaert":["brandweer"],
  "Alain Leemans":["brandweer","bevelvoerder","chauffeur","duiker"],
  "Hans Van Thielen":["bevelvoerder","brandweer"],
  "Joris Van Vracem":["ambulancier","brandweer","chauffeur"],
  "Rik Goris":["ambulancier","chauffeur","brandweer"],
  "Toon Vervoort":["brandweer"],
  "Wannes Verhegge":["brandweer","duiker"],
  "Christoph Verhaegen":["brandweer","chauffeur","ambulancier"],
  "Robbe Vervecken":["ambulancier","brandweer","chauffeur"],
  "Lander Mondelaers":["brandweer"],
  "Evans Ocran":["brandweer"],
  "Bob Debecker":["brandweer"]
};

function normalize(name){
  return name.toLowerCase().replace(/\s+/g," ").trim();
}

Object.keys(personeel).forEach(naam=>{
  const key = normalize(naam);
  db.ref("users/" + key).set({
    displayName: naam,
    roles: personeel[naam],
    permanentieCount: 0
  });
});

console.log("âœ… Personeel succesvol in Firebase geplaatst");
</script>
</body>
</html>

<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Brandweer Herentals ‚Äî Portal</title>
<link rel="manifest" href="/brandweerherentals/manifest.json">
<meta name="theme-color" content="#c71f1f">
<style>
:root {
  --red: #c71f1f;
  --dark: #111;
  --light: #fff;
  --muted: #f6f6f6;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
html, body { margin: 0; padding: 0; min-height: 100%; }
body { background: linear-gradient(180deg, #fff 0%, #f8f8f8 100%); display: flex; justify-content: center; align-items: flex-start; padding: 20px; -webkit-font-smoothing: antialiased; overflow-y: auto; }
.container { width: 100%; max-width: 780px; background: var(--light); border-radius: 18px; border: 4px solid var(--red); box-shadow: 0 8px 30px rgba(0,0,0,0.08); display: flex; flex-direction: column; height: auto; overflow: hidden; }
header { display: flex; align-items: center; justify-content: space-between; padding: 18px; background: linear-gradient(90deg, var(--red), #8f1515); color: var(--light); }
.header-left { display: flex; align-items: center; gap: 12px; }
header .logo { width: 52px; height: 52px; border-radius: 10px; background: rgba(255,255,255,0.08); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 20px; }
header h1 { margin: 0; font-size: 18px; }
header p { margin: 0; font-size: 12px; opacity: 0.9; }
#header-right { text-align: right; }
#datetime { font-size: 14px; opacity: 0.9; }
#ploegOfWeek { font-weight:600; font-size:14px; color:#fff; margin-top:2px; }
main.content { flex: 1 1 auto; padding: 18px; }
.grid { display: grid; gap: 12px; grid-template-columns: 1fr; }
@media (min-width: 620px) { .grid { grid-template-columns: 1fr 1fr; } }
.btn { display: flex; align-items: center; gap: 14px; padding: 16px; border-radius: 12px; text-decoration: none; font-weight: 700; font-size: 16px; box-shadow: 0 4px 8px rgba(0,0,0,0.04); transition: 0.06s; color: var(--dark); background: var(--muted); }
.btn:active { transform: translateY(1px); }
.btn .icon { width: 52px; height: 52px; min-width: 52px; border-radius: 10px; background: linear-gradient(180deg, #fff, #f0f0f0); display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.06); overflow: hidden; }
.btn img { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; }
.btn small { display: block; font-size: 12px; opacity: 0.8; margin-top: 4px; }
footer { padding: 12px 18px; font-size: 13px; color: #444; background: #fff; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
footer button {
  background: none;
  border: none;
  color: #c71f1f;
  font-weight: 700;
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
}
#installBtn, #updateBanner {
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #c71f1f;
  color: white;
  padding: 12px 20px;
  border-radius: 12px;
  font-weight: 700;
  z-index: 9999;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  cursor: pointer;
}
#iosOverlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 99999;
  justify-content: center;
  align-items: center;
}
#iosOverlay .box {
  background: white;
  padding: 20px;
  border-radius: 12px;
  text-align: center;
  width: 80%;
  max-width: 300px;
}
#iosOverlay button {
  margin-top: 12px;
  background: #c71f1f;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
}
</style>
</head>
<body>
<div class="container" role="application" aria-label="Fire Crew Herentals portal">
<header>
  <div class="header-left">
    <div class="logo">BWH</div>
    <div>
      <h1>Brandweer Herentals</h1>
      <p>Interne app</p>
    </div>
  </div>
 <div id="header-right">
  <div id="datetime"></div>
  <div id="ploegOfWeek"></div>
</div>
</header>
<main class="content">
  <div class="grid" id="buttonGrid"></div>
</main>
<footer>
  <div>Versie 1.1</div>
  <button id="footerInstall">üì± Voeg toe aan startscherm</button>
</footer>
</div>

<div id="installBtn">üì≤ App toevoegen aan startscherm</div>
<div id="updateBanner">üîÑ Nieuwe update beschikbaar, klik om te herladen</div>

<!-- Overlay voor iOS -->
<div id="iosOverlay">
  <div class="box">
    <h3>üì≤ Voeg toe aan beginscherm</h3>
    <p>Open het <strong>deel-icoon</strong> (‚¨ÜÔ∏è) onderaan je scherm en kies <em>‚ÄòZet op beginscherm‚Äô</em>.</p>
    <button onclick="document.getElementById('iosOverlay').style.display='none'">Sluiten</button>
  </div>
</div>

<script>
// üîó Links instellen
const links = {
  abiweb: { title: "Abiweb", icon: "/brandweerherentals/icons/buttons/abiweb.png", desc: "Oefeningen en prestaties", url: "https://identity.brandweerzonekempen.be/" },
  agenda: { title: "Agenda", icon: "üìÖ", desc: "Belangrijke data en evenementen", url: "/brandweerherentals/agenda.html" },
  defect: { title: "Defectmelding", icon: "üîß", desc: "Meld defecten", url: "https://forms.cloud.microsoft/" },
  kantine: { title: "Kantine", icon: "üçª", desc: "Bestel drank & snacks", url: "/brandweerherentals/kantine.html" }
};
const sorted = Object.values(links).sort((a,b)=>a.title.localeCompare(b.title,'nl'));
const grid=document.getElementById("buttonGrid");
sorted.forEach(item=>{
  const a=document.createElement("a");
  a.className="btn";
  a.href=item.url;
  a.innerHTML=`<div class="icon">${item.icon.endsWith(".png")?`<img src="${item.icon}">`:item.icon}</div>
  <div><div>${item.title}</div><small>${item.desc}</small></div>`;
  grid.appendChild(a);
});

// üïí Header
document.addEventListener("DOMContentLoaded",()=>{
  const datetimeEl=document.getElementById("datetime");
  const ploegEl=document.getElementById("ploegOfWeek");
  const cyclus=["A1","B1","C1","A2","B2","C2"];
  const ref=new Date("2025-01-03T12:00:00");
  function ploeg(){
    const diff=(Date.now()-ref)/604800000;
    return cyclus[Math.floor(diff)%cyclus.length];
  }
  function update(){
    const n=new Date();
    datetimeEl.textContent=n.toLocaleString('nl-BE',{weekday:'short',day:'2-digit',month:'short',hour:'2-digit',minute:'2-digit'});
    ploegEl.textContent="Ploeg van week: "+ploeg();
  }
  setInterval(update,1000);
  update();
});

// üì≤ Installatie
let deferredPrompt;
const footerBtn=document.getElementById("footerInstall");
const iosOverlay=document.getElementById("iosOverlay");
function showInstallButton(){footerBtn.style.display="flex";}

// Android & Windows
window.addEventListener("beforeinstallprompt",e=>{
  e.preventDefault(); deferredPrompt=e; showInstallButton();
});

footerBtn.addEventListener("click",async()=>{
  const ua=navigator.userAgent.toLowerCase();
  const isIOS=/iphone|ipad|ipod/.test(ua);
  const isEdge=ua.includes("edg");

  if(isIOS){
    iosOverlay.style.display="flex";
    return;
  }

  if(isEdge && !deferredPrompt){
    alert("‚ÑπÔ∏è In Edge: menu (‚Ä¶) ‚Üí ‚ÄòApps‚Äô ‚Üí ‚ÄòDeze site installeren‚Äô.");
    return;
  }

  if(deferredPrompt){
    deferredPrompt.prompt();
    const {outcome}=await deferredPrompt.userChoice;
    deferredPrompt=null;
  } else {
    alert("‚ÑπÔ∏è Gebruik het browsermenu om de app te installeren.");
  }
});

// iOS Fallback
window.addEventListener("load",()=>{
  const ua=navigator.userAgent.toLowerCase();
  const isIOS=/iphone|ipad|ipod/.test(ua);
  const isStandalone=window.navigator.standalone===true;
  if(isIOS && !isStandalone) showInstallButton();
});
</script>
</body>
</html>

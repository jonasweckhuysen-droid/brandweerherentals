<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Brandweer Herentals ‚Äî Portal</title>
<link rel="manifest" href="/brandweerherentals/manifest.json">
<meta name="theme-color" content="#c71f1f">
<style>
:root {
  --red: #c71f1f;
  --dark: #111;
  --light: #fff;
  --muted: #f6f6f6;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
html, body { margin: 0; padding: 0; min-height: 100%; }
body { background: linear-gradient(180deg, #fff 0%, #f8f8f8 100%); display: flex; justify-content: center; align-items: flex-start; padding: 20px; -webkit-font-smoothing: antialiased; overflow-y: auto; }
.container { width: 100%; max-width: 780px; background: var(--light); border-radius: 18px; border: 4px solid var(--red); box-shadow: 0 8px 30px rgba(0,0,0,0.08); display: flex; flex-direction: column; height: auto; overflow: hidden; }
header { display: flex; align-items: center; justify-content: space-between; padding: 18px; background: linear-gradient(90deg, var(--red), #8f1515); color: var(--light); }
.header-left { display: flex; align-items: center; gap: 12px; }
header .logo { width: 52px; height: 52px; border-radius: 10px; background: rgba(255,255,255,0.08); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 20px; }
header h1 { margin: 0; font-size: 18px; }
header p { margin: 0; font-size: 12px; opacity: 0.9; }
#header-right { text-align: right; }
#datetime { font-size: 14px; opacity: 0.9; }
#ploegOfWeek { font-weight:600; font-size:14px; color:#fff; margin-top:2px; }
main.content { flex: 1 1 auto; padding: 18px; }
.grid { display: grid; gap: 12px; grid-template-columns: 1fr; }
@media (min-width: 620px) { .grid { grid-template-columns: 1fr 1fr; } }
.btn { display: flex; align-items: center; gap: 14px; padding: 16px; border-radius: 12px; text-decoration: none; font-weight: 700; font-size: 16px; box-shadow: 0 4px 8px rgba(0,0,0,0.04); transition: 0.06s; color: var(--dark); background: var(--muted); }
.btn:active { transform: translateY(1px); }
.btn .icon { width: 52px; height: 52px; min-width: 52px; border-radius: 10px; background: linear-gradient(180deg, #fff, #f0f0f0); display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.06); overflow: hidden; }
.btn img { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; }
.btn small { display: block; font-size: 12px; opacity: 0.8; margin-top: 4px; }
footer { padding: 12px 18px; font-size: 13px; color: #444; background: #fff; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
#installBtn, #updateBanner {
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #c71f1f;
  color: white;
  padding: 12px 20px;
  border-radius: 12px;
  font-weight: 700;
  z-index: 9999;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  cursor: pointer;
}
#updateBanner { bottom: 70px; }
</style>
</head>
<body>
<div class="container" role="application" aria-label="Fire Crew Herentals portal">
<header>
  <div class="header-left">
    <div class="logo">BWH</div>
    <div>
      <h1>Brandweer Herentals</h1>
      <p>Interne app</p>
    </div>
  </div>
 <div id="header-right">
  <div id="datetime"></div>
  <div id="ploegOfWeek"></div>
</div>
</header>
<main class="content">
  <div class="grid" id="buttonGrid">
    <!-- Knoppen worden dynamisch alfabetisch toegevoegd -->
  </div>
</main>
<footer>
  <div>Versie 1.1</div>
  <div>üì± Voeg toe aan startscherm</div>
</footer>
</div>

<div id="installBtn">üì≤ App toevoegen aan startscherm</div>
<div id="updateBanner">üîÑ Nieuwe update beschikbaar, klik om te herladen</div>

<script>
// üîó Links instellen
const links = {
  abiweb: { title: "Abiweb", icon: "/brandweerherentals/icons/buttons/abiweb.png", desc: "Oefeningen en prestaties", url: "https://identity.brandweerzonekempen.be/Identity/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%3Fclient_id%3Dabiweb.client.new" },
  agenda: { title: "Agenda", icon: "üìÖ", desc: "Belangrijke data en evenementen", url: "/brandweerherentals/agenda.html" },
  defect: { title: "Defectmelding", icon: "üîß", desc: "Meld snel defecten aan materiaal of voertuigen", url: "https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUNTZUNVFFSUQwRldXTkpKREpGVlYyUzIwWC4u" },
  logistiek: { title: "Logistiek", icon: "/brandweerherentals/icons/buttons/winkelkar.png", desc: "Meld een logistiek transport aan", url: "https://form.jotform.com/230682691731055" },
  order: { title: "Bestelling", icon: "üì¶", desc: "Bestel materiaal of verbruiksgoederen", url: "https://forms.cloud.microsoft/e/GjHr1Kym0w" },
  vehicle: { title: "Voertuigreservatie", icon: "üöí", desc: "Reserveer een voertuig of controleer beschikbaarheid", url: "https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUN0JBTzkySTI0STFZUlk4Q01GOVRTR1UzMy4u" },
  verdi: { title: "Verdi", icon: "/brandweerherentals/icons/buttons/verdi.png", desc: "Oproepen en status aanpassen", url: "https://kempen.verdi.cloud/" },
  wegenwerken: { title: "Wegenwerken", icon: "üöß", desc: "Actuele info over werken in Herentals", url: "/brandweerherentals/wegenwerken.html" },
  wespen: { title: "Wespen", icon: "üêù", desc: "Ploeg van dienst wespenverdelging", url: "/brandweerherentals/wespen.html" }
};

// üî§ Alfabetisch sorteren & tonen
const sorted = Object.values(links).sort((a, b) => a.title.localeCompare(b.title, 'nl'));
const grid = document.getElementById("buttonGrid");
sorted.forEach(item => {
  const a = document.createElement("a");
  a.className = "btn";
  a.href = item.url;
  a.innerHTML = `
    <div class="icon">${item.icon.endsWith(".png") ? `<img src="${item.icon}" alt="${item.title}">` : item.icon}</div>
    <div>
      <div>${item.title}</div>
      <small>${item.desc}</small>
    </div>`;
  grid.appendChild(a);
});

// üïí Datum & tijd updaten + ploeg van week
document.addEventListener("DOMContentLoaded", () => {
  const cyclus = ["A1", "B1", "C1", "A2", "B2", "C2"];
  const referentie = new Date("2025-01-03T12:00:00"); // vrijdag 3 januari 2025 om 12u

  function currentPloegVanWeek() {
    const now = new Date();
    const msPerWeek = 7 * 24 * 60 * 60 * 1000;
    const diffMs = now - referentie;
    const weeksElapsed = Math.floor(diffMs / msPerWeek);
    const index = ((weeksElapsed % cyclus.length) + cyclus.length) % cyclus.length;
    return cyclus[index];
  }

const datetimeEl = document.getElementById("datetime");
const ploegEl = document.getElementById("ploegOfWeek");

function updateHeader() {
  const now = new Date();
  const options = { weekday: 'short', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' };
  datetimeEl.textContent = now.toLocaleString('nl-BE', options); // datum boven
  ploegEl.textContent = "Ploeg van week: " + currentPloegVanWeek(); // ploeg eronder
}

setInterval(updateHeader, 1000);
updateHeader();
});

// üì≤ PWA installatie prompt
let deferredPrompt;
const installBtn = document.getElementById("installBtn");
window.addEventListener("beforeinstallprompt", e => {
  e.prompt();
  deferredPrompt = e;
  installBtn.style.display = "block";
});
installBtn.addEventListener("click", async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    installBtn.style.display = "none";
  }
});

// ‚öôÔ∏è Service worker met update melding
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/brandweerherentals/sw.js")
    .then(reg => {
      console.log("‚úÖ Service Worker geregistreerd");
      reg.addEventListener("updatefound", () => {
        const newWorker = reg.installing;
        newWorker.addEventListener("statechange", () => {
          if (newWorker.state === "installed" && navigator.serviceWorker.controller) {
            const banner = document.getElementById("updateBanner");
            banner.style.display = "block";
            banner.onclick = () => location.reload();
          }
        });
      });
    })
    .catch(err => console.error("‚ùå SW fout:", err));

  let refreshing;
  navigator.serviceWorker.addEventListener("controllerchange", () => {
    if (refreshing) return;
    refreshing = true;
    window.location.reload();
  });
}

// üçé iPhone/iPad melding (√©√©nmalig)
const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
const isInStandalone = window.navigator.standalone === true;
if (isIOS && !isInStandalone && !localStorage.getItem('iosInstallHintShown')) {
  alert("üì≤ Tip: Druk op het deel-icoon (vierkant met pijltje omhoog) en kies 'Zet op beginscherm' om deze app te installeren.");
  localStorage.setItem('iosInstallHintShown', 'true');
}
</script>
</body>
</html>



<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Brandweer Herentals â€” Portal</title>

<!-- PWA -->
<link rel="manifest" href="/brandweerherentals/manifest.json">
<meta name="theme-color" content="#c71f1f">

<!-- Centrale layout -->
<link rel="stylesheet" href="style.css">

</head>
<body>

<div class="container" role="application" aria-label="Brandweer Herentals portal">

  <!-- -----------------------------------
       HEADER
  ------------------------------------ -->
  <header id="appHeader">
  <div class="header-left">
    <div id="greeting" class="header-name"></div>
  </div>

  <div class="header-right">
    <div id="datetime" class="header-datetime"></div>
    <div id="ploegOfWeek" class="header-ploeg"></div>
  </div>
</header>

  <!-- -----------------------------------
       CONTENT
  ------------------------------------ -->
  <main class="content">

    <div class="grid" id="buttonGrid" aria-live="polite"></div>

    <!-- Install PWA prompt -->
    <div id="installPrompt" class="overlay" style="display:none;">
      <div class="overlay-content" role="dialog" aria-modal="true">
        <span id="installText">ðŸ“² Voeg de app toe aan je startscherm</span>
        <button id="installNow">Toevoegen</button>
        <span class="close" id="installClose">âœ–</span>
      </div>
    </div>

  </main>

  <!-- -----------------------------------
       FOOTER
  ------------------------------------ -->
  <footer>
    <div>Versie 1.1</div>
    <div></div>
  </footer>

</div> <!-- container -->

<!-- ================================
     SCRIPTS
=============================== -->
<script>
// =====================================
// ðŸ” Vraag naam + VZW status
// =====================================
let userName = localStorage.getItem("userName");
let isVZW = localStorage.getItem("isVZW");

async function askUser() {
  if (!userName) {
    userName = prompt("Wat is je naam?");
    if (userName) localStorage.setItem("userName", userName);
  }
  if (!isVZW) {
    let vzwInput = prompt("Ben je lid van de VZW? Vul wachtwoord in:");
    if (vzwInput === "Oudstrijder") {
      isVZW = "true";
      localStorage.setItem("isVZW", "true");
    } else {
      isVZW = "false";
      localStorage.setItem("isVZW", "false");
    }
  }
}
askUser();

// =====================================
// ðŸ”— Knoppen/grid
// =====================================
const links = {
  abiweb: { title:"Abiweb", icon:"/brandweerherentals/icons/buttons/abiweb.png", desc:"Oefeningen en prestaties", url:"https://identity.brandweerzonekempen.be/Identity/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%3Fclient_id%3Dabiweb.client.new" },
  agenda: { title:"Agenda", icon:"ðŸ“…", desc:"Belangrijke data en evenementen", url:"/brandweerherentals/agenda.html" },
  defect: { title:"Defectmelding", icon:"ðŸ”§", desc:"Meld defecten", url:"https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUNTZUNVFFSUQwRldXTkpKREpGVlYyUzIwWC4u" },
  kantine: { title:"Kantine", icon:"ðŸ»", desc:"Bestellen & betalen", url:"/brandweerherentals/kantine.html" },
  logistiek: { title:"Logistiek", icon:"/brandweerherentals/icons/buttons/winkelkar.png", desc:"Transport aanvragen", url:"https://form.jotform.com/230682691731055" },
  order: { title:"Bestelling", icon:"ðŸ“¦", desc:"Materiaal bestellen", url:"https://forms.cloud.microsoft/e/GjHr1Kym0w" },
  vehicle: { title:"Voertuigreservatie", icon:"ðŸš’", desc:"Controle & reservatie", url:"https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUN0JBTzkySTI0STFZUlk4Q01GOVRTR1UzMy4u" },
  verdi: { title:"Verdi", icon:"/brandweerherentals/icons/buttons/verdi.png", desc:"Oproepen", url:"https://kempen.verdi.cloud/" },
  wegenwerken: { title:"Wegenwerken", icon:"ðŸš§", desc:"Actuele info", url:"/brandweerherentals/wegenwerken.html" },
  wespen: { title:"Wespen", icon:"ðŸ", desc:"Ploeg van dienst", url:"/brandweerherentals/wespen.html" }
};

// Extra knop voor VZW
if (localStorage.getItem("isVZW") === "true") {
  links.firecrew = { title:"Firecrew", icon:"ðŸ”¥", desc:"Exclusief", url:"/brandweerherentals/firecrew.html" };
}

// Grid render
const grid = document.getElementById("buttonGrid");
Object.values(links).sort((a,b)=>a.title.localeCompare(b.title,"nl")).forEach(item => {
  const a = document.createElement("a");
  a.className = "btn";
  a.href = item.url;
  a.innerHTML = `
    <div class="icon">${item.icon.endsWith(".png")? `<img src="${item.icon}" alt="${item.title}">`:item.icon}</div>
    <div>
      <div>${item.title}</div>
      <small>${item.desc}</small>
    </div>
  `;
  grid.appendChild(a);
});

// =====================================
// ðŸ“² PWA INSTALL PROMPT
// =====================================
let deferredPrompt;
const installPrompt = document.getElementById("installPrompt");
const installBtn = document.getElementById("installNow");
const installClose = document.getElementById("installClose");

window.addEventListener("beforeinstallprompt", e => {
  e.preventDefault();
  deferredPrompt = e;
  installPrompt.style.display = "flex";
});

installBtn.addEventListener("click", async () => {
  const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);
  if (isIOS) { alert("Op iPhone/iPad: gebruik â€˜Zet op beginschermâ€™."); installPrompt.style.display="none"; return; }
  if (deferredPrompt) {
    deferredPrompt.prompt();
    const result = await deferredPrompt.userChoice;
    if(result.outcome==="accepted") localStorage.setItem("appInstalled","true");
    installPrompt.style.display="none";
  }
});

installClose.addEventListener("click", ()=>installPrompt.style.display="none");
</script>

<!-- Header script -->
<script src="/brandweerherentals/header.js"></script>

</body>
</html>



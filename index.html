<!doctype html>
<html lang="nl">    
<head>    
<meta charset="utf-8">    
<meta name="viewport" content="width=device-width, initial-scale=1">    
<title>Brandweer Herentals â€” Portal</title>

<!-- PWA -->
<link rel="manifest" href="/brandweerherentals/manifest.json">    
<meta name="theme-color" content="#c71f1f">

<link rel="stylesheet" href="style.css">

<style>
/* ===============================
   VERPLICHTE INSTALL OVERLAY
================================ */
#forceInstall {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.92);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  color: #fff;
  text-align: center;
  padding: 20px;
}

#forceInstall .box {
  background: #111;
  border-radius: 16px;
  padding: 28px;
  max-width: 360px;
  width: 100%;
  box-shadow: 0 0 30px rgba(0,0,0,0.6);
}

#forceInstall h2 {
  color: var(--red);
  margin-bottom: 12px;
}

#forceInstall p {
  font-size: 0.95rem;
  margin-bottom: 20px;
  line-height: 1.4;
}

#forceInstall button {
  width: 100%;
  padding: 14px;
  border-radius: 12px;
  border: none;
  background: var(--red);
  color: #fff;
  font-size: 1.05rem;
  font-weight: 700;
  cursor: pointer;
}
</style>
</head>

<body>

<!-- VERPLICHTE INSTALL -->
<div id="forceInstall" style="display:none;">
  <div class="box">
    <h2>ðŸ“² App installeren</h2>
    <p>
      Deze applicatie werkt enkel als geÃ¯nstalleerde app.<br>
      Voeg ze toe aan je startscherm om verder te gaan.
    </p>
    <button id="forceInstallBtn">Installeer app</button>
  </div>
</div>

<div class="container" style="display:none;" id="appContent">

<!-- HEADER -->
<header id="appHeader">
  <div class="header-left">
    <img src="/brandweerherentals/icons/logo.png" alt="Brandweer Herentals" class="header-logo">    
  </div>
  <div class="header-right">
    <div id="greeting" class="header-greeting"></div>    
    <div id="datetime" class="header-datetime"></div>    
    <div id="ploegOfWeek" class="header-ploeg"></div>    
  </div>
</header>

<main class="content">    
  <div class="grid" id="buttonGrid"></div>  
</main>

<footer>    
  <div>Versie 1.1</div>    
</footer>    

</div>

<script>
// =====================================
// ðŸ”— LINKS
// =====================================
let links = {    
  abiweb: { title:"Abiweb", icon:"/brandweerherentals/icons/buttons/abiweb.png", desc:"Oefeningen en prestaties", url:"https://abiweb.brandweerzonekempen.be/" },    
  agenda: { title:"Agenda", icon:"ðŸ“…", desc:"Belangrijke data", url:"/brandweerherentals/agenda.html" },    
  defect: { title:"Defectmelding", icon:"ðŸ”§", desc:"Meld defecten", url:"/brandweerherentals/defectmelding.html" },    
  logistiek: { title:"Logistiek", icon:"/brandweerherentals/icons/buttons/winkelkar.png", desc:"Transport aanvragen", url:"https://form.jotform.com/230682691731055" },    
  order: { title:"Bestelling", icon:"ðŸ“¦", desc:"Materiaal bestellen", url:"https://forms.cloud.microsoft/e/GjHr1Kym0w" },    
  vehicle: { title:"Voertuigreservatie", icon:"ðŸš’", desc:"Controle & reservatie", url:"https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUN0JBTzkySTI0STFZUlk4Q01GOVRTR1UzMy4u" },    
  verdi: { title:"Verdi", icon:"/brandweerherentals/icons/buttons/verdi.png", desc:"Oproepen", url:"https://kempen.verdi.cloud/" },    
  wegenwerken: { title:"Wegenwerken", icon:"ðŸš§", desc:"Actuele info", url:"/brandweerherentals/wegenwerken.html" },    
  wespen: { title:"Wespen", icon:"ðŸ", desc:"Ploeg van dienst", url:"/brandweerherentals/wespen.html" },    
  permanentie: { title:"Permanentie", icon:"ðŸ•’", desc:"Planning", url:"/brandweerherentals/permanentie.html" },

  /* ðŸ”¥ NIEUW */
  vlam: {
    title:"VLAM",
    icon:"ðŸ”¥",
    desc:"VLAM platform",
    url:"https://vlam.brandweerzonekempen.be/"
  }
};

// =====================================
// ðŸ“² VERPLICHT INSTALLEREN
// =====================================
let deferredPrompt;
const forceInstall = document.getElementById("forceInstall");
const forceInstallBtn = document.getElementById("forceInstallBtn");
const appContent = document.getElementById("appContent");

window.addEventListener("beforeinstallprompt", e => {
  e.preventDefault();
  deferredPrompt = e;

  if (!localStorage.getItem("appInstalled")) {
    forceInstall.style.display = "flex";
  }
});

forceInstallBtn.addEventListener("click", async () => {
  const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);

  if (isIOS) {
    alert("Gebruik 'Zet op beginscherm' via de deelknop.");
    return;
  }

  if (deferredPrompt) {
    deferredPrompt.prompt();
    const choice = await deferredPrompt.userChoice;
    if (choice.outcome === "accepted") {
      localStorage.setItem("appInstalled", "true");
      location.reload();
    }
  }
});

// =====================================
// â–¶ï¸ START APP
// =====================================
window.addEventListener("DOMContentLoaded", () => {
  if (localStorage.getItem("appInstalled")) {
    forceInstall.style.display = "none";
    appContent.style.display = "block";
    renderGrid();
  }
});

// =====================================
// ðŸ§© GRID
// =====================================
function renderGrid() {
  const grid = document.getElementById("buttonGrid");
  grid.innerHTML = "";

  Object.values(links)
    .sort((a,b)=>a.title.localeCompare(b.title,"nl"))
    .forEach(item => {
      const a = document.createElement("a");
      a.className = "btn";
      a.href = item.url;
      a.innerHTML = `
        <div class="icon">${item.icon.endsWith(".png") ? `<img src="${item.icon}">` : item.icon}</div>
        <div>
          <div>${item.title}</div>
          <small>${item.desc}</small>
        </div>`;
      grid.appendChild(a);
    });
}
</script>

<script src="/brandweerherentals/header.js"></script>
</body>
</html>

<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Brandweer Herentals â€” Portal</title>

<link rel="manifest" href="/brandweerherentals/manifest.json">
<meta name="theme-color" content="#c71f1f">
<link rel="stylesheet" href="style.css">

<style>
#forceInstall, #nameOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.92);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10000;
  color:#fff;
}

.box{
  background:#111;
  padding:28px;
  border-radius:16px;
  max-width:360px;
  width:100%;
  text-align:center;
}

input,button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  margin-top:10px;
}

button{
  background:#c71f1f;
  color:#fff;
  font-weight:700;
}
</style>
</head>

<body>

<!-- INSTALL -->
<div id="forceInstall" style="display:none;">
  <div class="box">
    <h2>ðŸ“² App installeren</h2>
    <p>Installeer de app om verder te gaan</p>
    <button id="forceInstallBtn">Installeer</button>
  </div>
</div>

<!-- NAAM -->
<div id="nameOverlay" style="display:none;">
  <div class="box">
    <h2>ðŸ‘¤ Identificatie</h2>
    <p>Voornaam + Achternaam<br><small>bv. Jonas Weckhuysen</small></p>
    <input id="nameInput" placeholder="Voornaam Achternaam">
    <button id="saveName">Verder</button>
    <small id="nameError" style="color:#ff6b6b;display:none;">Ongeldige naam</small>
  </div>
</div>

<div class="container" style="display:none;" id="appContent">

<header id="appHeader">
  <div class="header-left">
    <img src="/brandweerherentals/icons/logo.png" class="header-logo">
  </div>
  <div class="header-right">
    <div id="greeting"></div>
    <div id="datetime"></div>
    <div id="ploegOfWeek"></div>
  </div>
</header>

<main class="content">
  <div class="grid" id="buttonGrid"></div>
</main>

<footer><div>Versie 1.1</div></footer>
</div>

<script>
// ================= LINKS MET RECHTEN =================
const links = {
  abiweb:{title:"Abiweb",icon:"/brandweerherentals/icons/buttons/abiweb.png",desc:"Oefeningen",url:"https://abiweb.brandweerzonekempen.be/",roles:[]},
  agenda:{title:"Agenda",icon:"ðŸ“…",desc:"Belangrijke data",url:"/brandweerherentals/agenda.html",roles:[]},
  defect:{title:"Defectmelding",icon:"ðŸ”§",desc:"Meld defecten",url:"/brandweerherentals/defectmelding.html",roles:[]},
  logistiek:{title:"Logistiek",icon:"ðŸ›’",desc:"Transport",url:"https://form.jotform.com/230682691731055",roles:["chauffeur"]},
  order:{title:"Bestelling",icon:"ðŸ“¦",desc:"Materiaal",url:"https://forms.cloud.microsoft/e/GjHr1Kym0w",roles:[]},
  vehicle:{title:"Voertuigreservatie",icon:"ðŸš’",desc:"Reservatie",url:"https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=ex_6l868RE6S2t-IkEL0dqocXptaGhNPlV-vS_rmuEtUN0JBTzkySTI0STFZUlk4Q01GOVRTR1UzMy4u",roles:["chauffeur"]},
  verdi:{title:"Verdi",icon:"/brandweerherentals/icons/buttons/verdi.png",desc:"Oproepen",url:"https://kempen.verdi.cloud/",roles:[]},
  wegenwerken:{title:"Wegenwerken",icon:"ðŸš§",desc:"Info",url:"/brandweerherentals/wegenwerken.html",roles:[]},
  wespen:{title:"Wespen",icon:"ðŸ",desc:"Ploeg",url:"/brandweerherentals/wespen.html",roles:[]},
  permanentie:{title:"Permanentie",icon:"ðŸ•’",desc:"Planning",url:"/brandweerherentals/permanentie.html",roles:[]},
  vlam:{title:"VLAM",icon:"ðŸ”¥",desc:"VLAM platform",url:"https://vlam.brandweerzonekempen.be/",roles:[]}
};

// ================= PERSONEEL =================
const personnel = {
  "Jonas Weckhuysen":["chauffeur","ambulancier","brandweer","duiker"],
  "Steven Maes":["chauffeur","ambulancier","brandweer"],
  "Bart Boons":["ambulancier","duiker","brandweer"],
  "Bob Debecker":["brandweer"]
  // ðŸ‘‰ rest identiek uitbreidbaar (bewust zo gelaten)
};

// ================= NAAM =================
const regex=/^[A-Z][a-zÃ -Ã¿]+ [A-Z][a-zÃ -Ã¿]+$/;

saveName.onclick=()=>{
  const name=nameInput.value.trim();
  if(!regex.test(name)||!personnel[name]){
    nameError.style.display="block";
    return;
  }
  localStorage.setItem("userName",name);
  location.reload();
};

// ================= GRID =================
function renderGrid(){
  const roles=personnel[localStorage.getItem("userName")]||[];
  const grid=document.getElementById("buttonGrid");
  grid.innerHTML="";

  Object.values(links)
    .sort((a,b)=>a.title.localeCompare(b.title,"nl"))
    .forEach(l=>{
      const allowed =
        l.roles.length===0 ||
        roles.includes("brandweer") && !l.roles.includes("ambulancier") && !l.roles.includes("chauffeur") && !l.roles.includes("duiker") ||
        l.roles.some(r=>roles.includes(r));

      if(!allowed) return;

      const a=document.createElement("a");
      a.className="btn";
      a.href=l.url;
      a.innerHTML=`
        <div class="icon">${l.icon.endsWith(".png")?`<img src="${l.icon}">`:l.icon}</div>
        <div><div>${l.title}</div><small>${l.desc}</small></div>`;
      grid.appendChild(a);
    });
}

// ================= START =================
window.addEventListener("DOMContentLoaded",()=>{
  if(!localStorage.getItem("userName")){
    nameOverlay.style.display="flex";
    return;
  }
  appContent.style.display="block";
  renderGrid();
});
</script>

<script src="/brandweerherentals/header.js"></script>
</body>
</html>

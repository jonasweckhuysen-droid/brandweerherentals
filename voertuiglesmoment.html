<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chauffeur Oefenmomenten ‚Äî Brandweer Herentals</title>
<link rel="stylesheet" href="style.css">
<style>
/* Container */
.container {
  max-width:900px;
  margin:0 auto 20px auto;
  background:#fff;
  border-radius:20px;
  box-shadow:0 6px 15px rgba(0,0,0,0.1);
  overflow:hidden;
}

/* Header */
#appHeader {
  background:#c62828;
  color:white;
  padding:15px 20px;
  display:flex;
  align-items:center;
  gap:20px;
  border-radius:20px 20px 0 0; /* rode achtergrond volledig doorlopend */
}

/* Logo */
.header-logo {
  height:60px;
  flex-shrink:0;
}

/* Header tekst rechts van logo */
.header-text {
  display:flex;
  flex-direction:column;
  justify-content:center;
  line-height:1.4;
}

.header-greeting,
.header-datetime,
.header-ploeg {
  margin:2px 0;
  font-weight:600;
}

/* Backlink en zoekbalk */
.backlink {
  display:inline-block;
  margin:20px 0 10px 0;
  padding:6px 12px;
  background:#c62828;
  color:white;
  font-weight:600;
  border-radius:8px;
  text-decoration:none;
}

#searchInput {
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:1rem;
  margin-bottom:20px;
}

/* Chauffeur cards */
.chauffeur-card {
  background:#f9f9f9;
  padding:15px;
  border-radius:12px;
  margin-bottom:20px;
  border-left:6px solid #c62828;
}

/* Vehicle & exercises layout */
.vehicle {
  margin-top:10px;
  padding:10px;
  border:1px solid #eee;
  border-radius:12px;
  background:#fff;
}

.veh-header {
  display:flex;
  justify-content:space-between;
  font-weight:bold;
  margin-bottom:8px;
}

.veh-left {
  display:flex;
  align-items:center;
}

.exercise-list label {
  display:block;
  margin-bottom:4px;
}

.select-all-label {
  font-size:0.85rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:6px;
}
</style>
</head>

<body>

<div class="container">

  <!-- HEADER -->
  <header id="appHeader">
    <img src="/brandweerherentals/icons/logo.png" class="header-logo" alt="Brandweer Herentals">
    <div class="header-text">
      <div id="greeting" class="header-greeting"></div>
      <div id="datetime" class="header-datetime"></div>
      <div id="ploegOfWeek" class="header-ploeg"></div>
    </div>
  </header>

  <main>
    <a href="index.html" class="backlink">‚Üê Terug naar menu</a>
    <input type="text" id="searchInput" placeholder="Zoek op naam...">
    <div id="chauffeurContainer"></div>
  </main>

</div>

<script src="header.js"></script>
<script>
/* Gebruiker */
const huidigeGebruiker = localStorage.getItem("userName") || "Onbekend";
document.getElementById("greeting").textContent = `Welkom ${huidigeGebruiker}`;

/* Datum & Tijd stabiel met seconden */
function updateDateTime(){
  const now = new Date();
  const date = now.toLocaleDateString('nl-BE');
  const time = now.toLocaleTimeString('nl-BE',{hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false});
  document.getElementById("datetime").textContent = `${date} ${time}`;
}
setInterval(updateDateTime,1000);
updateDateTime();

/* Ploeg van de week */
const ploegen = ["Ploeg A","Ploeg B","Ploeg C","Ploeg D"];
const weekNum = Math.ceil((new Date() - new Date(new Date().getFullYear(),0,1))/604800000);
document.getElementById("ploegOfWeek").textContent = `Ploeg van de week: ${ploegen[weekNum % ploegen.length]}`;

/* Admin check */
const admins = ["Patrick Van Hove","Alain Leemans","Jonas Weckhuysen","Danny Van Den Bergh"];
const isAdmin = admins.includes(huidigeGebruiker);

/* Chauffeurs */
const chauffeurs = [
  "Dries Boven","Robin Buyens","Bart Cools","Kurt Cools","Gianni Cornelis",
  "Roel Dekort","Rik Goris","Kris Hoeylaerts","Philippe Hoeylaerts","Vincent Leemans",
  "Bart Leten","Steven Maes","Liese Meyskens","Rutger Moons","Sven Van Buren",
  "Jakke Van den Broeck","Kris Van Looveren","No√´l Van Roy","Joris Van Vracem",
  "Cristoph Verhaegen","Robbe Vervecken","Steven Vervloet"
];

/* Oefenmomenten */
const oefenmomenten = {
  "B541":[1,2,3,4,5,6],"L544":[1,2,3,4],"L549":[1,2,3,4,5],
  "A545":[1,2,3,4,5,6],"D541":[1,2,3],"M545":[1,2,3,4],
  "T545":[1,2,3,4,5,6],"H541":[1,2,3,4,5,6],"A541":[1,2,3,4,5,6],
  "Containers":[1]
};

/* Groepen & sets */
const mid = Math.ceil(chauffeurs.length/2);
const groep1 = chauffeurs.slice(0, mid);
const groep2 = chauffeurs.slice(mid);
const setA = ["T545","H541","A541","Containers"];
const setB = ["B541","L544","L549","A545","D541","M545"];
const maand = new Date().getMonth()+1;
const isVoorjaar = maand <=6;
function getVoertuigenVoorChauffeur(chauffeur){
  return groep1.includes(chauffeur)? (isVoorjaar? setB:setA) : (isVoorjaar? setA:setB);
}

/* Render chauffeurs met teller */
const containerDiv = document.getElementById("chauffeurContainer");
function renderChauffeurs(filter=""){
  containerDiv.innerHTML="";
  filter=filter.toLowerCase();

  chauffeurs.forEach(chauffeur=>{
    if(!isAdmin && chauffeur!==huidigeGebruiker) return;
    if(filter && !chauffeur.toLowerCase().includes(filter)) return;

    const voertuigen = getVoertuigenVoorChauffeur(chauffeur);
    const card = document.createElement("div");
    card.className="chauffeur-card";

    const h3 = document.createElement("h3");
    h3.textContent=chauffeur+" ";
    const counter = document.createElement("span");
    counter.className="counter";
    counter.textContent="0 / 0 oefenmomenten voltooid";
    h3.appendChild(counter);
    card.appendChild(h3);

    let totaleOefenmomenten = 0;
    const allCheckboxes = [];

    voertuigen.forEach(voertuig=>{
      if(!oefenmomenten[voertuig]) return;
      totaleOefenmomenten += oefenmomenten[voertuig].length;

      const vehicleDiv = document.createElement("div");
      vehicleDiv.className="vehicle";

      const vhHeader = document.createElement("div");
      vhHeader.className="veh-header";

      const vhLeft = document.createElement("div");
      vhLeft.className="veh-left";
      vhLeft.textContent="üöí "+voertuig;

      const selectAllLabel = document.createElement("label");
      selectAllLabel.className="select-all-label";
      const selectAllCheckbox = document.createElement("input");
      selectAllCheckbox.type="checkbox";
      selectAllLabel.appendChild(selectAllCheckbox);
      selectAllLabel.appendChild(document.createTextNode(" Alles aanduiden"));

      vhHeader.appendChild(vhLeft);
      vhHeader.appendChild(selectAllLabel);
      vehicleDiv.appendChild(vhHeader);

      const exerciseDiv = document.createElement("div");
      exerciseDiv.className="exercise-list";

      oefenmomenten[voertuig].forEach(num=>{
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type="checkbox";
        allCheckboxes.push(input);
        label.appendChild(input);
        label.appendChild(document.createTextNode(` Oefenmoment ${num}`));
        exerciseDiv.appendChild(label);

        input.addEventListener("change", updateCounter);
      });

      selectAllCheckbox.addEventListener("change",()=>{
        const startIndex = allCheckboxes.length - oefenmomenten[voertuig].length;
        for(let i=0;i<oefenmomenten[voertuig].length;i++){
          allCheckboxes[startIndex+i].checked = selectAllCheckbox.checked;
        }
        updateCounter();
      });

      vehicleDiv.appendChild(exerciseDiv);
      card.appendChild(vehicleDiv);
    });

    function updateCounter(){
      const voltooide = allCheckboxes.filter(cb=>cb.checked).length;
      counter.textContent = `${voltooide} / ${totaleOefenmomenten} oefenmomenten voltooid`;
    }

    updateCounter();
    containerDiv.appendChild(card);
  });

  if(!containerDiv.hasChildNodes()){
    containerDiv.innerHTML="<div style='color:#666;padding:12px;border-radius:8px;background:#fff;border:1px dashed #ddd;'>Geen chauffeurs gevonden of geen rechten.</div>";
  }
}

renderChauffeurs();
document.getElementById("searchInput").addEventListener("input", e=>renderChauffeurs(e.target.value));
</script>

</body>
</html>

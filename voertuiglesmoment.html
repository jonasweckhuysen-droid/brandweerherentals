<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chauffeur Oefenmomenten ‚Äî Brandweer Herentals</title>

<style>
body {
  margin:0;
  font-family: Arial, sans-serif;
  background:#f2f4f7;
}

.container {
  max-width:900px;
  margin:0 auto 20px auto;
  background:#fff;
  border-radius:20px;
  box-shadow:0 6px 15px rgba(0,0,0,0.1);
  padding:0 20px 20px 20px;
}

/* ===== HEADER ZELFDE ALS ANDERE PAGINA ===== */
header#appHeader {
  background:#c62828;
  color:white;
  padding:15px 20px;
  border-radius:20px 20px 0 0;
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
}

.header-logo {
  height:60px;
  margin-bottom:10px;
}

.header-greeting {
  font-size:1.1rem;
  font-weight:600;
}

.header-datetime,
.header-ploeg {
  font-size:0.95rem;
  opacity:0.9;
}
/* ============================================= */

.backlink {
  text-decoration:none;
  font-weight:600;
  display:inline-block;
  margin:25px 0 20px 0;
  color:white;
  background:#c62828;
  padding:6px 12px;
  border-radius:8px;
}

#searchInput {
  padding:10px 12px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:1rem;
  margin-bottom:20px;
  width:100%;
}

.chauffeur-card {
  background:#f9f9f9;
  padding:15px;
  border-radius:12px;
  margin-bottom:20px;
  border-left:6px solid #c62828;
}

.chauffeur-card h3 {
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.counter {
  font-size:0.9rem;
  color:#555;
}

.vehicle {
  margin-top:10px;
  padding:10px;
  border:1px solid #eee;
  border-radius:12px;
  background:#fff;
}

.veh-header {
  font-weight:bold;
  margin-bottom:8px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}

.veh-left {
  display:flex;
  align-items:center;
}

.exercise-list label {
  display:block;
  margin-bottom:4px;
}

.select-all-label {
  font-size:0.85rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:6px;
}
</style>
</head>

<body>

<div class="container">

<header id="appHeader">
  <div class="header-left">
    <img src="/brandweerherentals/icons/logo.png" alt="Brandweer Herentals" class="header-logo">    
  </div>
  <div class="header-right">
    <div id="greeting" class="header-greeting"></div>    
    <div id="datetime" class="header-datetime"></div>    
    <div id="ploegOfWeek" class="header-ploeg"></div>    
  </div>
</header>

<main>
  <a href="index.html" class="backlink">‚Üê Terug naar menu</a>
  <input type="text" id="searchInput" placeholder="Zoek op naam...">
  <div id="chauffeurContainer"></div>
</main>

</div>

<script>
/* ========== GEBRUIKER UIT LOCALSTORAGE ========== */
const huidigeGebruiker = localStorage.getItem("userName") || "Onbekend";
document.getElementById("greeting").textContent = `Welkom ${huidigeGebruiker}`;

/* DATUM & TIJD */
function updateDateTime(){
  const now = new Date();
  document.getElementById("datetime").textContent = now.toLocaleString("nl-BE");
}
setInterval(updateDateTime, 1000);
updateDateTime();

/* ========== ADMINS ========== */
const admins = ["Patrick Van Hove","Alain Leemans","Jonas Weckhuysen","Danny Van Den Bergh"];
const isAdmin = admins.includes(huidigeGebruiker);

/* ========== CHAUFFEURS (ORIGINELE VOLGORDE) ========== */
const chauffeurs = [
  "Dries Boven", "Robin Buyens", "Bart Cools", "Kurt Cools", "Gianni Cornelis",
  "Roel Dekort", "Rik Goris", "Kris Hoeylaerts", "Philippe Hoeylaerts", "Vincent Leemans",
  "Bart Leten", "Steven Maes", "Liese Meyskens", "Rutger Moons", "Sven Van Buren",
  "Jakke Van den Broeck", "Kris Van Looveren", "No√´l Van Roy", "Joris Van Vracem",
  "Cristoph Verhaegen", "Robbe Vervecken", "Steven Vervloet"
];

/* ========== OEFENMOMENTEN ========== */
const oefenmomenten = {
  "B541":[1,2,3,4,5,6],
  "L544":[1,2,3,4],
  "L549":[1,2,3,4,5],
  "A545":[1,2,3,4,5,6],
  "D541":[1,2,3],
  "M545":[1,2,3,4],
  "T545":[1,2,3,4,5,6],
  "H541":[1,2,3,4,5,6],
  "A541":[1,2,3,4,5,6],
  "Containers":[1]
};

/* ========== GROEPEN ========== */
const mid = Math.ceil(chauffeurs.length / 2);
const groep1 = chauffeurs.slice(0, mid);
const groep2 = chauffeurs.slice(mid);

/* ========== SETS ========== */
const setA = ["B541","L544","L549","A545","D541","M545"];
const setB = ["T545","H541","A541","Containers"];

/* ========== SEIZOEN ========== */
const maand = new Date().getMonth() + 1;
const isVoorjaar = maand <= 6;

/* ========== LOGICA ========== */
function getVoertuigenVoorChauffeur(chauffeur){
  if (groep1.includes(chauffeur)) {
    return isVoorjaar ? setB : setA;
  } else {
    return isVoorjaar ? setA : setB;
  }
}

/* ========== COUNTER FUNCTIE ========== */
function updateCounter(card){
  const allCheckboxes = card.querySelectorAll('.exercise-list input[type="checkbox"]');
  const checked = card.querySelectorAll('.exercise-list input[type="checkbox"]:checked');
  const counter = card.querySelector(".counter");

  counter.textContent = `${checked.length} / ${allCheckboxes.length} oefenmomenten voltooid`;
}

/* ========== RENDER ========== */
const containerDiv = document.getElementById("chauffeurContainer");

function renderChauffeurs(filter=""){
  containerDiv.innerHTML="";
  filter = filter.toLowerCase();

  chauffeurs.forEach(chauffeur=>{

    if(!isAdmin && chauffeur !== huidigeGebruiker) return;
    if(filter && !chauffeur.toLowerCase().includes(filter)) return;

    const voertuigen = getVoertuigenVoorChauffeur(chauffeur);

    const card = document.createElement("div");
    card.className="chauffeur-card";

    const h3 = document.createElement("h3");
    h3.textContent = chauffeur + " ";
    const counter = document.createElement("span");
    counter.className = "counter";
    counter.textContent = "0 / 0 oefenmomenten voltooid";
    h3.appendChild(counter);
    card.appendChild(h3);

    voertuigen.forEach(voertuig=>{
      if(!oefenmomenten[voertuig]) return;

      const vehicleDiv = document.createElement("div");
      vehicleDiv.className = "vehicle";

      const vehHeader = document.createElement("div");
      vehHeader.className = "veh-header";

      const vehLeft = document.createElement("div");
      vehLeft.className = "veh-left";
      vehLeft.textContent = "üöí " + voertuig;

      const selectAllLabel = document.createElement("label");
      selectAllLabel.className = "select-all-label";

      const selectAllCheckbox = document.createElement("input");
      selectAllCheckbox.type = "checkbox";

      selectAllLabel.appendChild(selectAllCheckbox);
      selectAllLabel.appendChild(document.createTextNode(" Alles aanduiden"));

      vehHeader.appendChild(vehLeft);
      vehHeader.appendChild(selectAllLabel);
      vehicleDiv.appendChild(vehHeader);

      const exerciseDiv = document.createElement("div");
      exerciseDiv.className = "exercise-list";

      const checkboxes = [];

      oefenmomenten[voertuig].forEach(num=>{
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type="checkbox";
        checkboxes.push(input);

        input.addEventListener("change", () => {
          updateCounter(card);
          selectAllCheckbox.checked = checkboxes.every(cb => cb.checked);
        });

        label.appendChild(input);
        label.appendChild(document.createTextNode(` Oefenmoment ${num}`));
        exerciseDiv.appendChild(label);
      });

      selectAllCheckbox.addEventListener("change", () => {
        checkboxes.forEach(cb => cb.checked = selectAllCheckbox.checked);
        updateCounter(card);
      });

      vehicleDiv.appendChild(exerciseDiv);
      card.appendChild(vehicleDiv);
    });

    updateCounter(card);
    containerDiv.appendChild(card);
  });

  if(!containerDiv.hasChildNodes()){
    containerDiv.innerHTML="<div style='color:#666;padding:12px;border-radius:8px;background:#fff;border:1px dashed #ddd;'>Geen chauffeurs gevonden of geen rechten.</div>";
  }
}

renderChauffeurs();
document.getElementById("searchInput").addEventListener("input",e=>renderChauffeurs(e.target.value));
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Chauffeur Oefenmomenten ‚Äî Brandweer Herentals</title>
<link rel="stylesheet" href="style.css">
<style>
  :root {
    --red: #c62828;
  }

  body {
    margin: 0;
    font-family: Arial, Helvetica, sans-serif;
    background: #f2f4f7;
  }

  /* container card */
  .container {
    max-width: 900px;
    margin: 20px auto;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    padding: 20px;
    position: relative;
    overflow: visible;
  }

  /* header: laat 'm visueel uitsteken zodat hij tot in de afgeronde hoeken kleur geeft */
  header#appHeader {
    display:flex;
    justify-content:space-between;
    align-items:center;
    background: var(--red);
    color: #fff;
    padding: 14px 20px;
    border-radius: 12px;
    margin: -20px -20px 16px -20px; /* hierdoor vult de header de bovenkant van de container volledig */
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    border: 1px solid var(--red);
  }

  .header-left, .header-right { display:flex; align-items:center; gap:10px; }
  .header-logo { height:50px; }

  .header-greeting, .header-datetime, .header-ploeg {
    margin:0; font-weight:700; color:white; font-size:0.95rem;
  }

  /* zorg dat terug-knop wit is en ruimte heeft (spatie onder header) */
  .backlink {
    display:inline-block;
    margin: 12px 0 18px 0; /* ruimte boven en onder */
    padding: 8px 12px;
    background: var(--red);
    color: #fff;
    text-decoration: none;
    border-radius: 8px;
    font-weight:700;
  }

  #searchInput {
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 1rem;
    margin-bottom: 20px;
    width: 100%;
  }

  .chauffeur-card {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 12px;
    margin-bottom: 20px;
    border-left: 6px solid var(--red);
  }

  .chauffeur-card h3 {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin:0 0 8px 0;
  }

  .counter { font-size:0.9rem; color:#555; font-weight:600; }

  .vehicle {
    margin-top:10px;
    padding:10px;
    border:1px solid #eee;
    border-radius:12px;
    background:#fff;
  }

  .veh-header { display:flex; justify-content:space-between; align-items:center; font-weight:700; margin-bottom:8px; }

  .exercise-list label { display:block; margin-bottom:6px; cursor: pointer; }

  .info-btn { background:transparent; border:none; cursor:pointer; font-size:1.05rem; }

  .modal {
    display:none;
    position:fixed;
    z-index:1000;
    left:0; top:0; width:100%; height:100%;
    overflow:auto;
    background-color:rgba(0,0,0,0.5);
  }

  .modal-content {
    background:#fff; margin:8% auto; padding:18px; border-radius:12px; width:92%; max-width:640px;
  }
  .close-modal { float:right; cursor:pointer; font-size:1.2rem; font-weight:700; }

  .call-btn {
    margin-top:8px; padding:8px 12px; border-radius:8px; text-decoration:none; background:var(--red); color:#fff; font-weight:700; display:inline-block;
  }
</style>
</head>
<body>
  <div class="container">

    <!-- HEADER -->
    <header id="appHeader">
      <div class="header-left">
        <img src="/brandweerherentals/icons/logo.png" alt="Brandweer Herentals" class="header-logo">
      </div>
      <div class="header-right">
        <div id="greeting" class="header-greeting"></div>
        <div id="datetime" class="header-datetime"></div>
        <div id="ploegOfWeek" class="header-ploeg"></div>
      </div>
    </header>

    <main>
      <a href="index.html" class="backlink">‚Üê Terug naar menu</a>

      <input type="text" id="searchInput" placeholder="Zoek op naam..." aria-label="Zoek op naam">

      <div id="chauffeurContainer"></div>
    </main>

    <div id="modal" class="modal" role="dialog" aria-modal="true">
      <div class="modal-content">
        <span class="close-modal" aria-label="Sluit">‚úñ</span>
        <div id="modalText"></div>
      </div>
    </div>

  </div>

<script>
/*
  Belangrijk: deze code gebruikt exact de volgorde van de keys in het 'chauffeurs' object
  zoals jij die hieronder zet. Er wordt g√©√©n extra alfabetische sortering meer gedaan.
*/

/* === DATA (houd exact jouw gewenste volgorde hier) === */
const chauffeurs = {
  "Dries Boven": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Robin Buyens": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Bart Cools": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Kurt Cools": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Gianni Cornelis": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Roel Dekort": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Rik Goris": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Kris Hoeylaerts": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Philippe Hoeylaerts": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Vincent Leemans": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Bart Leten": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Steven Maes": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Liese Meyskens": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Rutger Moons": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Sven Van Buren": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Jakke Van den Broeck": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Kris Van Looveren": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "No√´l Van Roy": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Joris Van Vracem": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Cristoph Verhaegen": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Robbe Vervecken": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Steven Vervloet": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"]
};

/* oefenmomenten per voertuig */
const oefenmomenten = {
  "B541":[1,2,3,4,5,6],
  "L544":[1,2,3,4],
  "L549":[1,2,3,4,5],
  "A545":[1,2,3,4,5,6],
  "D541":[1,2,3],
  "M545":[1,2,3,4],
  "L545":[1,2,3],
  "T545":[1,2,3,4,5,6],
  "H541":[1,2,3,4,5,6],
  "A541":[1,2,3,4,5,6],
  "Containers":[1]
};

/* uitleg per voertuig (modal) */
const oefenUitleg = {
  "L544":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Juist gebruik voertuig & signalisatie"],
  "L549":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met containersysteem","5: Werken met kraan/takel"],
  "H541":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Afstempelen & ladderpakket","5: Procedure evacuatie","6: Blussen vanuit korf"],
  "D541":["1: Kennis schakelaars & instrumenten","2: Rijden + koppelen aanhangwagen","3: Kennis bepakking"],
  "M545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met winch + stroomgroep"],
  "T545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & sproeibalk","5: Gebruik wateraanvoeren","6: Aanzuigen open water"],
  "L545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking + watercontainer"],
  "A545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & schuim","5: Wateraanvoeren","6: Gebruik lichtmast"],
  "A541":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & schuim","5: Wateraanvoeren & winch","6: Gebruik lichtmast"],
  "B541":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & schuim","5: Werken met winch","6: Procedures natuurbrand"],
  "Containers":["1: Kunnen werken met container"]
};

/* === groepslogica === */
/* gebruik exact de volgorde van Object.keys(chauffeurs) zoals hierboven ‚Äî g√©√©n sort */
const currentDate = new Date();
const month = currentDate.getMonth() + 1;
const isVoorjaar = (month >= 1 && month <= 6);
const jaarModulo = currentDate.getFullYear() % 2;

const orderedChauffeurs = Object.keys(chauffeurs); // behoudt de volgorde zoals in object
const mid = Math.ceil(orderedChauffeurs.length / 2);
const groep1 = orderedChauffeurs.slice(0, mid);
const groep2 = orderedChauffeurs.slice(mid);

/* voertuigen sets per groepsafspraak */
const voorjaarG1 = ["B541","L544","L549","A545","D541","M545"];
const najaarG1 = ["T545","H541","A541","Containers"];
const voorjaarG2 = najaarG1;
const najaarG2 = voorjaarG1;

/* kies voertuigen per chauffeur op basis van groep + periode + jaar modulo */
function getVoertuigenVoorChauffeur(chauffeur) {
  // jaarModulo bepaalt of we in dit jaar groep1-start met voorjaarG1 of omgekeerd
  const groep1Voorjaar = (jaarModulo === 0) ? voorjaarG1 : najaarG1;
  const groep1Najaar = (jaarModulo === 0) ? najaarG1 : voorjaarG1;
  const groep2Voorjaar = (jaarModulo === 0) ? voorjaarG2 : najaarG2;
  const groep2Najaar = (jaarModulo === 0) ? najaarG2 : voorjaarG2;

  if (groep1.includes(chauffeur)) {
    return isVoorjaar ? groep1Voorjaar : groep1Najaar;
  } else {
    return isVoorjaar ? groep2Voorjaar : groep2Najaar;
  }
}

/* DOM refs */
const containerDiv = document.getElementById("chauffeurContainer");
const modal = document.getElementById("modal");
const modalText = document.getElementById("modalText");
const closeModal = document.querySelector(".close-modal");

closeModal.onclick = () => modal.style.display = "none";
window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };

/* Render functie: gebruikt de exacte volgorde uit orderedChauffeurs */
function renderChauffeurs(filter = "") {
  filter = (filter || "").toLowerCase();
  containerDiv.innerHTML = "";

  for (let chauffeur of orderedChauffeurs) {
    // zoek op naam (gewenst door jou)
    if (filter && !chauffeur.toLowerCase().includes(filter)) continue;

    const voertuigen = getVoertuigenVoorChauffeur(chauffeur);

    // bouw kaart
    const card = document.createElement("div");
    card.className = "chauffeur-card";

    // teller totaal / voltooid
    let totaal = 0, voltooid = 0;
    voertuigen.forEach(v => totaal += (oefenmomenten[v] || []).length);
    voertuigen.forEach(v => {
      (oefenmomenten[v] || []).forEach(n => {
        if (localStorage.getItem(`${chauffeur}_${v}_${n}`) === "true") voltooid++;
      });
    });

    const h3 = document.createElement("h3");
    h3.textContent = chauffeur + " ";
    const counterSpan = document.createElement("span");
    counterSpan.className = "counter";
    counterSpan.textContent = `${voltooid} / ${totaal} oefenmomenten voltooid`;
    h3.appendChild(counterSpan);
    card.appendChild(h3);

    // voertuigen & oefenmomenten
    voertuigen.forEach(voertuig => {
      const vehicleDiv = document.createElement("div");
      vehicleDiv.className = "vehicle";

      const vehHeader = document.createElement("div");
      vehHeader.className = "veh-header";
      vehHeader.innerHTML = `üöí ${voertuig} <button class="info-btn" aria-label="info ${voertuig}">‚ÑπÔ∏è</button>`;
      vehicleDiv.appendChild(vehHeader);

      const exerciseDiv = document.createElement("div");
      exerciseDiv.className = "exercise-list";

      (oefenmomenten[voertuig] || []).forEach(num => {
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type = "checkbox";
        input.dataset.chauffeur = chauffeur;
        input.dataset.vehicle = voertuig;
        input.dataset.exercise = num;

        const key = `${chauffeur}_${voertuig}_${num}`;
        input.checked = (localStorage.getItem(key) === "true");

        input.addEventListener("change", () => {
          // bewaar als 'true'/'false' (string); consistent met eerdere code
          localStorage.setItem(key, input.checked ? "true" : "false");
          // her-render zodat teller en UI up-to-date is
          renderChauffeurs(document.getElementById("searchInput").value);
        });

        label.appendChild(input);
        label.appendChild(document.createTextNode(` Oefenmoment ${num}`));
        exerciseDiv.appendChild(label);
      });

      vehicleDiv.appendChild(exerciseDiv);

      // info knop: modal met uitleg
      const infoBtn = vehHeader.querySelector(".info-btn");
      infoBtn.addEventListener("click", () => {
        const uitleg = oefenUitleg[voertuig] || [ "Geen extra uitleg beschikbaar." ];
        modalText.innerHTML = `<h4>${voertuig} ‚Äî oefenmomenten</h4><ul>` +
          uitleg.map(x => `<li>${x}</li>`).join("") +
          `</ul>`;
        modal.style.display = "block";
      });

      card.appendChild(vehicleDiv);
    });

    containerDiv.appendChild(card);
  }

  // indien geen resultaten
  if (!containerDiv.hasChildNodes()) {
    containerDiv.innerHTML = "<div style='color:#666;padding:12px;border-radius:8px;background:#fff;border:1px dashed #ddd;'>Geen chauffeurs gevonden.</div>";
  }
}

/* init */
renderChauffeurs();

/* zoekbalk: zoekt op naam (hele naam of deeltekst) */
document.getElementById("searchInput").addEventListener("input", function() {
  renderChauffeurs(this.value);
});

/* optionele: populeren van header (greeting/datetime) als header.js niet alles al doet */
(function fillHeaderFallback(){
  try {
    if (!document.getElementById("greeting").textContent) {
      const name = localStorage.getItem("userName") || "";
      if (name) document.getElementById("greeting").textContent = `Welkom, ${name}!`;
    }
    // datum/tijd fallback
    const dtEl = document.getElementById("datetime");
    if (dtEl && !dtEl.textContent) {
      const d = new Date();
      dtEl.textContent = d.toLocaleString();
    }
  } catch(e) { /* noop */ }
})();
</script>

<script src="/brandweerherentals/header.js"></script>
</body>
</html>

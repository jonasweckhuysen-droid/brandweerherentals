<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chauffeur Oefenmomenten ‚Äî Brandweer Herentals</title>
<link rel="stylesheet" href="style.css">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f2f4f7;
}

.container {
  max-width: 900px;
  margin: 20px auto;
  background: #fff;
  border-radius: 15px;
  box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  padding: 20px;
}

.backlink {
  text-decoration: none;
  font-weight: 600;
  display: inline-block;
  margin-bottom: 20px;
  color: #c62828;
}

#searchInput {
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 1rem;
  margin-bottom: 20px;
  width: 100%;
}

.chauffeur-card {
  background: #f9f9f9;
  padding: 15px;
  border-radius: 12px;
  margin-bottom: 20px;
  border-left: 6px solid #c62828;
}

.chauffeur-card h3 {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.counter {
  font-size: 0.9rem;
  color: #555;
}

.vehicle {
  margin-top: 10px;
  padding: 10px;
  border: 1px solid #eee;
  border-radius: 12px;
  background: #fff;
}

.veh-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: bold;
  margin-bottom: 8px;
}

.exercise-list label {
  display: block;
  margin-bottom: 4px;
}

.info-btn {
  background: transparent;
  border: none;
  cursor: pointer;
  font-size: 1.1rem;
}

.modal {
  display: none; 
  position: fixed;
  z-index: 1000;
  left: 0; top: 0;
  width: 100%; height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.5);
}

.modal-content {
  background: #fff;
  margin: 10% auto;
  padding: 20px;
  border-radius: 12px;
  width: 90%;
  max-width: 600px;
}

.close-modal {
  float: right;
  cursor: pointer;
  font-size: 1.2rem;
  font-weight: bold;
}

.call-btn {
  margin-top: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  text-align: center;
  text-decoration: none;
  background: #c62828;
  color: white;
  font-weight: bold;
  display: inline-block;
}

.call-btn:hover {
  opacity: 0.9;
}
</style>
</head>
<body>

<div class="container">

  <!-- HEADER (Exact gelijk aan index.html) -->
  <header id="appHeader">
    <div class="header-left">
      <img src="/brandweerherentals/icons/logo.png" alt="Brandweer Herentals" class="header-logo">
    </div>
    <div class="header-right">
      <div id="greeting" class="header-greeting"></div>
      <div id="datetime" class="header-datetime"></div>
      <div id="ploegOfWeek" class="header-ploeg"></div>
    </div>
  </header>

  <main>
    <a href="index.html" class="backlink">‚Üê Terug naar menu</a>
    <input type="text" id="searchInput" placeholder="Zoek op voertuig of oefenmoment...">
    <div id="chauffeurContainer"></div>
  </main>

  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close-modal">‚úñ</span>
      <div id="modalText"></div>
    </div>
  </div>

</div>

<script>
const chauffeurs = {
  "Dries Boven": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Robin Buyens": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Bart Cools": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Kurt Cools": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Gianni Cornelis": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Roel Dekort": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Rik Goris": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Kris Hoeylaerts": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Philippe Hoeylaerts": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Vincent Leemans": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Bart Leten": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Steven Maes": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Liese Meyskens": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Rutger Moons": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Sven Van Buren": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Jakke Van den Broeck": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Kris Van Looveren": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "No√´l Van Roy": ["B541","L544","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Joris Van Vracem": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Cristoph Verhaegen": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"],
  "Robbe Vervecken": ["B541","L544","L549","A545","D541","M545","L545","T545","A541","Containers"],
  "Steven Vervloet": ["B541","L544","L549","A545","D541","M545","L545","T545","H541","A541","Containers"]
};

const oefenmomenten = {
  "B541":[1,2,3,4,5,6],
  "L544":[1,2,3,4],
  "L549":[1,2,3,4,5],
  "A545":[1,2,3,4,5,6],
  "D541":[1,2,3],
  "M545":[1,2,3,4],
  "L545":[1,2,3],
  "T545":[1,2,3,4,5,6],
  "H541":[1,2,3,4,5,6],
  "A541":[1,2,3,4,5,6],
  "Containers":[1]
};

const oefenUitleg = {
  "L544":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Juist gebruik voertuig & signalisatie"],
  "L549":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met containersysteem","5: Werken met kraan/takel"],
  "H541":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Afstempelen & ladderpakket","5: Procedure evacuatie","6: Blussen vanuit korf"],
  "D541":["1: Kennis schakelaars & instrumenten","2: Rijden + koppelen aanhangwagen","3: Kennis bepakking"],
  "M545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met winch + stroomgroep"],
  "T545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & sproeibalk","5: Gebruik wateraanvoeren","6: Aanzuigen open water"],
  "L545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking + watercontainer"],
  "A545":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & schuim","5: Wateraanvoeren","6: Gebruik lichtmast"],
  "A541":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & schuim","5: Wateraanvoeren & winch","6: Gebruik lichtmast"],
  "B541":["1: Kennis schakelaars & instrumenten","2: Rijden","3: Kennis bepakking","4: Werken met pomp & schuim","5: Werken met winch","6: Procedures natuurbrand"],
  "Containers":["1: Kunnen werken met container"]
};

let currentUser = localStorage.getItem("username") || "";
const admins = ["Alain Leemans","Danny Van den Bergh","Patrick Van Hove"];
const containerDiv = document.getElementById("chauffeurContainer");
const modal = document.getElementById("modal");
const modalText = document.getElementById("modalText");
const closeModal = document.querySelector(".close-modal");

closeModal.onclick = () => modal.style.display="none";
window.onclick = e => { if(e.target === modal) modal.style.display="none"; };

let visibleChauffeurs = currentUser && !admins.includes(currentUser) ? 
  { [currentUser]: chauffeurs[currentUser] } : chauffeurs;

function renderChauffeurs(filter="") {
  containerDiv.innerHTML="";
  for (let [chauffeur, voertuigen] of Object.entries(visibleChauffeurs)) {
    const card = document.createElement("div");
    card.className = "chauffeur-card";

    let totaal = 0, voltooid = 0;
    voertuigen.forEach(v => totaal += oefenmomenten[v].length);
    voertuigen.forEach(v => {
      oefenmomenten[v].forEach(num => {
        const key = `${chauffeur}_${v}_${num}`;
        if(localStorage.getItem(key) === "true") voltooid++;
      });
    });

    const h3 = document.createElement("h3");
    h3.textContent = `${chauffeur} `;
    const counterSpan = document.createElement("span");
    counterSpan.className="counter";
    counterSpan.textContent = `${voltooid} / ${totaal} oefenmomenten voltooid`;
    h3.appendChild(counterSpan);
    card.appendChild(h3);

    voertuigen.forEach(voertuig => {
      if(filter && !voertuig.toLowerCase().includes(filter.toLowerCase())) return;

      const vehicleDiv = document.createElement("div");
      vehicleDiv.className = "vehicle";

      const vehHeader = document.createElement("div");
      vehHeader.className = "veh-header";
      vehHeader.innerHTML = `üöí ${voertuig} <button class="info-btn">‚ÑπÔ∏è</button>`;
      vehicleDiv.appendChild(vehHeader);

      const exerciseDiv = document.createElement("div");
      exerciseDiv.className = "exercise-list";

      oefenmomenten[voertuig].forEach(num => {
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type="checkbox";
        input.dataset.chauffeur = chauffeur;
        input.dataset.vehicle = voertuig;
        input.dataset.exercise = num;

        const key = `${chauffeur}_${voertuig}_${num}`;
        input.checked = localStorage.getItem(key) === "true";

        input.addEventListener("change", ()=>{
          localStorage.setItem(key,input.checked);
          renderChauffeurs(document.getElementById("searchInput").value);
        });

        label.appendChild(input);
        label.appendChild(document.createTextNode(` Oefenmoment ${num}`));
        exerciseDiv.appendChild(label);
      });

      vehicleDiv.appendChild(exerciseDiv);

      const infoBtn = vehHeader.querySelector(".info-btn");
      infoBtn.addEventListener("click",()=>{
        modalText.innerHTML = `<h4>${voertuig} oefenmomenten:</h4><ul>`+
          oefenUitleg[voertuig].map(x=>`<li>${x}</li>`).join('')+
          `</ul>`;
        modal.style.display="block";
      });

      card.appendChild(vehicleDiv);
    });

    containerDiv.appendChild(card);
  }
}

renderChauffeurs();

document.getElementById("searchInput").addEventListener("input", function() {
  renderChauffeurs(this.value);
});
</script>

<script src="/brandweerherentals/header.js"></script>
</body>
</html>
